<?xml version="1.0" encoding="utf-8" ?>
<ContentView x:Class="MauiAuthPageTemplate.Controls.PinCodeLockView"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:converter="clr-namespace:MauiAuthPageTemplate.Converters"
			 xmlns:local="clr-namespace:MauiAuthPageTemplate.Controls"
			 x:DataType="local:PinCodeLockView"
             x:Name="Root">

	<ContentView.Resources>
		<ResourceDictionary>
			<converter:PinCircleFillConverter x:Key="pinCircleFillConverter" />
		</ResourceDictionary>

		<Style TargetType="Ellipse">
			<Setter Property="HorizontalOptions" Value="Center" />
			<Setter Property="VerticalOptions" Value="Center" />
			<Setter Property="Fill" Value="Transparent" />
			<Setter Property="StrokeThickness" Value="2" />
			<Setter Property="Stroke" Value="SlateGray" />
			<Setter Property="HeightRequest" Value="12" />
			<Setter Property="WidthRequest" Value="12" />
			<Setter Property="Margin" Value="4" />
		</Style>
		
		<Style TargetType="Button">
			<Setter Property="WidthRequest" Value="72" />
			<Setter Property="HeightRequest" Value="72" />
			<Setter Property="CornerRadius" Value="8" />
			<Setter Property="FontSize" Value="24" />
			<Setter Property="TextColor" Value="DarkSlateGray" />
			<Setter Property="BackgroundColor" Value="Transparent" />
			<Setter Property="VisualStateManager.VisualStateGroups">
				<VisualStateGroupList>
					<VisualStateGroup Name="CommonStates">
						
						<VisualState Name="Normal">
							<VisualState.Setters>
								<Setter Property="BackgroundColor" Value="Transparent" />
							</VisualState.Setters>
						</VisualState>
						
						<VisualState Name="Pressed">
							<VisualState.Setters>
								<Setter Property="BackgroundColor" Value="#22000000" />
								<Setter Property="Shadow">
									<Shadow Brush="Black"
											Offset="2,2"
											Radius="6"
											Opacity="0.3" />
								</Setter>
							</VisualState.Setters>
						</VisualState>
						
					</VisualStateGroup>
				</VisualStateGroupList>
			</Setter>
		</Style>
	</ContentView.Resources>

	<!-- Строка визуализации ПИН-кода -->
	<VerticalStackLayout Padding="8"
	                     HorizontalOptions="Center"
	                     Spacing="12"
	                     VerticalOptions="Center">
		<Border BackgroundColor="Transparent"
		        HorizontalOptions="Center"
		        Stroke="Gray"
		        StrokeShape="RoundRectangle 12"
		        StrokeThickness="2"
		        VerticalOptions="Center">

			<Grid ColumnDefinitions="Auto, Auto, Auto, Auto"
			      ColumnSpacing="12"
			      HorizontalOptions="Center"
			      VerticalOptions="Center">
				<Ellipse Grid.Column="0" Fill="{Binding Source={x:Reference Root}, Path=PinCode, Converter={StaticResource pinCircleFillConverter}, ConverterParameter=1}" />
				<Ellipse Grid.Column="1" Fill="{Binding Source={x:Reference Root}, Path=PinCode, Converter={StaticResource pinCircleFillConverter}, ConverterParameter=2}" />
				<Ellipse Grid.Column="2" Fill="{Binding Source={x:Reference Root}, Path=PinCode, Converter={StaticResource pinCircleFillConverter}, ConverterParameter=3}" />
				<Ellipse Grid.Column="3" Fill="{Binding Source={x:Reference Root}, Path=PinCode, Converter={StaticResource pinCircleFillConverter}, ConverterParameter=4}" />
			</Grid>
		</Border>

		<!--  Кнопки  -->
		<Grid ColumnDefinitions="Auto, Auto, Auto"
		      RowDefinitions="Auto, Auto, Auto, Auto"
		      ColumnSpacing="8"
		      RowSpacing="8">
			
			<!-- Row 0 -->
			<Button Text="1" Grid.Row="0" Grid.Column="0" Command="{Binding Source={x:Reference Root}, Path=AddDigitCommand}" CommandParameter="1" />
			<Button Text="2" Grid.Row="0" Grid.Column="1" Command="{Binding Source={x:Reference Root}, Path=AddDigitCommand}" CommandParameter="2" />
			<Button Text="3" Grid.Row="0" Grid.Column="2" Command="{Binding Source={x:Reference Root}, Path=AddDigitCommand}" CommandParameter="3" />

			<!-- Row 1 -->
			<Button Text="4" Grid.Row="1" Grid.Column="0" Command="{Binding Source={x:Reference Root}, Path=AddDigitCommand}" CommandParameter="4" />
			<Button Text="5" Grid.Row="1" Grid.Column="1" Command="{Binding Source={x:Reference Root}, Path=AddDigitCommand}" CommandParameter="5" />
			<Button Text="6" Grid.Row="1" Grid.Column="2" Command="{Binding Source={x:Reference Root}, Path=AddDigitCommand}" CommandParameter="6" />

			<!-- Row 2 -->
			<Button Text="7" Grid.Row="2" Grid.Column="0" Command="{Binding Source={x:Reference Root}, Path=AddDigitCommand}" CommandParameter="7" />
			<Button Text="8" Grid.Row="2" Grid.Column="1" Command="{Binding Source={x:Reference Root}, Path=AddDigitCommand}" CommandParameter="8" />
			<Button Text="9" Grid.Row="2" Grid.Column="2" Command="{Binding Source={x:Reference Root}, Path=AddDigitCommand}" CommandParameter="9" />

			<!-- Row 3 -->
			<Button Text="⌫" Grid.Row="3" Grid.Column="0" Command="{Binding Source={x:Reference Root}, Path=RemoveDigitCommand}" />
			<Button Text="0" Grid.Row="3" Grid.Column="1" Command="{Binding Source={x:Reference Root}, Path=AddDigitCommand}" CommandParameter="0" />
		</Grid>
	</VerticalStackLayout>
</ContentView>
